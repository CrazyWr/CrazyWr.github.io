<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>shell - 参数解析三种方式(手工, getopts, getopt) | 面向信仰</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">shell - 参数解析三种方式(手工, getopts, getopt)</h1><a id="logo" href="/.">面向信仰</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> HOME</i></a><a href="/archives/"><i class="fa fa-archive"> ARCHIVE</i></a><a href="/about/"><i class="fa fa-user"> ABOUT</i></a><a href="/book/"><i class="fa fa-book"> BOOK</i></a><a href="/wiki/"><i class="fa fa-list"> WIKI</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">shell - 参数解析三种方式(手工, getopts, getopt)</h1><div class="post-meta">Dec 19, 2017<span> | </span><span class="category"><a href="/categories/linux/">Linux</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1,867</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 8</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#选项和参数"><span class="toc-text">选项和参数:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#手工处理"><span class="toc-text">手工处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getopts"><span class="toc-text">getopts</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#getopts-用法"><span class="toc-text">getopts 用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#变量"><span class="toc-text">变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OPTSTRING"><span class="toc-text">OPTSTRING</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getopt"><span class="toc-text">getopt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#getopt-用法"><span class="toc-text">getopt 用法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#选项标准化"><span class="toc-text">选项标准化</span></a></li></ol></div></div><div class="post-content"><h3 id="选项和参数"><a href="#选项和参数" class="headerlink" title="选项和参数:"></a>选项和参数:</h3><ul>
<li>Argument, Option: 中文对应「选项」，形如 -a, –save 的都是选项；选项可以接收参数（Parameter），也可以不接受参数。其中-a 为短选项, –save 为长选项</li>
<li>Flag: 中文对应「标签」，形如 -v(verbose)；标签是布尔值，不接受参数。</li>
</ul>
<p>bash shell 汇总有三种解析参数的方式:</p>
<ul>
<li>手工处理:   大多数简单的命令</li>
<li>getopts:  大多数复杂命令, 不支持长选项</li>
<li>getopt:  支持长选项, getopts和getopt功能相似但又不完全相同，其中getopt是独立的可执行文件，而getopts是由Bash内置的</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ./<span class="keyword">test</span>.<span class="keyword">sh</span> -v -f -<span class="keyword">out</span> /<span class="keyword">test</span>.<span class="keyword">log</span> --prefix=/home</div></pre></td></tr></table></figure>
<p>  <strong>如果执行是permission denied: test.sh, 运行 chmod +x test.sh 赋予其可执行权限 或是 通过sh/bash 命令运行</strong></p>
<h3 id="手工处理"><a href="#手工处理" class="headerlink" title="手工处理"></a>手工处理</h3><ul>
<li>$0 : 在用sh 或者 ./执行脚本时，指的是脚本名，用source或.执行时，永运是bash，这也反应了sh 或者 ./执行脚本的原理和source的方式是不同的.</li>
<li>$1 : -v,第一个参数.</li>
<li>$2 : -f</li>
<li>$3 : -out</li>
<li>$4 : /test.log </li>
<li>依次类推 $5 $6 …</li>
<li>$# : 参数的个数，不包括命令本身，上例中\$#为5.</li>
<li>$@ : 参数本身的列表，也不包括命令本身，如上例为 -v -f -out /test.log –prefix=/home</li>
<li>$* : 参数本身的列表，也不包括命令本身，但”$*” 和”\$@”(加引号)并不同，”$*“将所有的参数解释成一个字符串，而”$@”是一个参数数组。如下例所示：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> <span class="string">"$*"</span></div><div class="line"><span class="keyword">do</span></div><div class="line">    <span class="built_in">echo</span> <span class="variable">$arg</span></div><div class="line"><span class="keyword">done</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> <span class="string">"<span class="variable">$@</span>"</span></div><div class="line"><span class="keyword">do</span></div><div class="line">    <span class="built_in">echo</span> <span class="variable">$arg</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby">v -f -out /test.log --prefix=<span class="regexp">/home</span></span></div><div class="line"><span class="ruby">-v</span></div><div class="line"><span class="ruby">-f</span></div><div class="line"><span class="ruby">-out</span></div><div class="line"><span class="ruby">/test.log</span></div><div class="line"><span class="ruby">--prefix=<span class="regexp">/home</span></span></div></pre></td></tr></table></figure>
<p><strong>也就是说手工处理方式高度依赖命令行中参数的位置, 只适合简单的参数较少的命令, 手工处理方式能满足大多数的简单需求，配合shift使用也能构造出强大的功能</strong></p>
<h3 id="getopts"><a href="#getopts" class="headerlink" title="getopts"></a>getopts</h3><p>先来看看参数传递的典型用法:</p>
<ul>
<li>./test.sh -a -b -c  ： 短选项，各选项不需参数</li>
<li>./test.sh -abc   ： 短选项，和上一种方法的效果一样，只是将所有的选项写在一起。</li>
<li>./test.sh -a args -b -c ：短选项，其中-a需要参数，而-b -c不需参数。</li>
<li>./test.sh –a-long=args –b-long ：长选项</li>
</ul>
<h4 id="getopts-用法"><a href="#getopts-用法" class="headerlink" title="getopts 用法"></a>getopts 用法</h4><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><ul>
<li><strong>OPTIND</strong>: getopts 在解析传入 Shell 脚本的参数时（也就是 $@），并不会执行 shift 操作，而是通过变量 OPTIND 来记住接下来要解析的参数的位置。</li>
<li><p><strong>OPTARG</strong>: getopts 在解析到选项的参数时，就会将参数保存在 OPTARG 变量当中；如果 getopts 遇到不合法的选项，择把选项本身保存在 OPTARG 当中。</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getopts OPTSTRING VARNAME <span class="string">[ARGS...]</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong>OPTSTRING</strong> 记录合法的选项列表（以及参数情况)</p>
</li>
<li><strong>VARNAME</strong> 则传入一个 Shell 变量的名字，用于保存 getopts 解析到的选项的名字（而不是参数值，参数值保存在 OPTARG 里）</li>
<li><strong>ATGS…</strong> 是可选的，默认是 $@，即传入 Shell 脚本的全部参数</li>
</ul>
<p>通常来说，我们会将 getopts 放在 while 循环的条件判断式中。getopts 在顺利解析到参数的时候，会返回 TRUE；否则返回 FALSE，用以结束循环.<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span> <span class="built_in">getopts</span> ...; <span class="keyword">do</span></div><div class="line">    ...</div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<p>getopts 在两种情况下会停止解析并返回 FALSE：</p>
<ul>
<li>getopts 读入不以 - 开始的字符串；比如: sh test.sh flag</li>
<li>getopts 读入连续的两个 - (i.e. –)</li>
</ul>
<h4 id="OPTSTRING"><a href="#OPTSTRING" class="headerlink" title="OPTSTRING"></a>OPTSTRING</h4><p>通过 <strong>OPTSTRING</strong> getopts 知道哪些参数是合法的，哪些参数又是需要接受参数的。<br>OPTSTRING 的格式很简单，就是一个简单的字符串。字符串里，每一个字母（大小写均可，但区分大小写）都是一个选项的名字。</p>
<p><strong>值得一提的是冒号 (:)</strong><br>在 OPTSTRING 中，冒号有两种含义：</p>
<ul>
<li>首位的 : 表示「不打印错误信息」；</li>
<li><p>紧邻字母（选项名字）的 : 表示该选项接收一个参数。</p>
<p>例如: </p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">getopts aBcD VARNAME <span class="comment">// 该脚本接受四个标签-a, -B, -c, -D, 均不接受参数</span></div><div class="line"><span class="string">getopts :</span><span class="string">aB:</span>Cd VARNAME <span class="comment">// 该脚本接受两个标签-a, -B, 两个短选项-C, -d</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>下面是实例:<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$@</span>"</span></div><div class="line"><span class="keyword">while</span> <span class="built_in">getopts</span> <span class="string">":a:bc:"</span> opt; <span class="keyword">do</span> <span class="comment">#不打印错误信息, -a -c需要参数 -b 不需要传参  </span></div><div class="line">  <span class="keyword">case</span> <span class="variable">$opt</span> <span class="keyword">in</span></div><div class="line">    a)</div><div class="line">      <span class="built_in">echo</span> <span class="string">"-a arg:<span class="variable">$OPTARG</span> index:<span class="variable">$OPTIND</span>"</span> <span class="comment">#$OPTIND指的下一个选项的index</span></div><div class="line">      ;;</div><div class="line">    b)</div><div class="line">      <span class="built_in">echo</span> <span class="string">"-b arg:<span class="variable">$OPTARG</span> index:<span class="variable">$OPTIND</span>"</span></div><div class="line">      ;;</div><div class="line">    c) </div><div class="line">      <span class="built_in">echo</span> <span class="string">"-c arg:<span class="variable">$OPTARG</span> index:<span class="variable">$OPTIND</span>"</span></div><div class="line">      ;;</div><div class="line">    :)</div><div class="line">      <span class="built_in">echo</span> <span class="string">"Option -<span class="variable">$OPTARG</span> requires an argument."</span> </div><div class="line">      <span class="built_in">exit</span> 1</div><div class="line">      ;;</div><div class="line">    ?) <span class="comment">#当有不认识的选项的时候arg为?</span></div><div class="line">      <span class="built_in">echo</span> <span class="string">"Invalid option: -<span class="variable">$OPTARG</span> index:<span class="variable">$OPTIND</span>"</span></div><div class="line">      ;;</div><div class="line">    </div><div class="line">  <span class="keyword">esac</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
  <figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">$ ./test<span class="selector-class">.sh</span> -<span class="selector-tag">a</span> ssss -<span class="selector-tag">b</span> ssss -c</div><div class="line">  &gt;&gt;</div><div class="line">  -<span class="selector-tag">a</span> ssss -<span class="selector-tag">b</span> ssss -c</div><div class="line">  -<span class="selector-tag">a</span> arg:ssss index:<span class="number">3</span></div><div class="line">  -<span class="selector-tag">b</span> arg: index:<span class="number">4</span> #-b并不接受参数, 解析到ssss时直接停止解析</div><div class="line"></div><div class="line">$ ./test<span class="selector-class">.sh</span>  -c xxx -<span class="selector-tag">b</span> -<span class="selector-tag">a</span> ssssss</div><div class="line">  &gt;&gt;</div><div class="line">  -c xxx -<span class="selector-tag">b</span> -<span class="selector-tag">a</span> ssssss</div><div class="line">  -c arg:xxx index:<span class="number">3</span></div><div class="line">  -<span class="selector-tag">b</span> arg: index:<span class="number">4</span></div><div class="line">  -<span class="selector-tag">a</span> arg:ssssss index:<span class="number">6</span></div><div class="line"></div><div class="line">$ ./test<span class="selector-class">.sh</span>  -c -<span class="selector-tag">b</span> -<span class="selector-tag">a</span> ssssss  <span class="comment">// -c 后面没有参数 -b会解析成-c参数</span></div><div class="line">  &gt;&gt;</div><div class="line">  -c -<span class="selector-tag">b</span> -<span class="selector-tag">a</span> ssssss</div><div class="line">  -c arg:-b</div><div class="line">  -<span class="selector-tag">a</span> arg:ssssss</div><div class="line">  </div><div class="line">$ ./test<span class="selector-class">.sh</span> -a</div><div class="line">  &gt;&gt; </div><div class="line">  a</div><div class="line">  Option -<span class="selector-tag">a</span> requires an argument.</div></pre></td></tr></table></figure>
<h3 id="getopt"><a href="#getopt" class="headerlink" title="getopt"></a>getopt</h3><p>  getopt较bash内置的getopts更强大，其不仅支持短参-s，还支持–longopt的长参数，甚至支持-longopt的简化参数。相较于getopts ，getopts 不但支持长短选项，其还支持选项和参数放在一起写。</p>
<h4 id="getopt-用法"><a href="#getopt-用法" class="headerlink" title="getopt 用法"></a>getopt 用法</h4><figure class="highlight gams"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getopt [<span class="keyword">options</span>] -o|--<span class="keyword">options</span> optstring [<span class="keyword">options</span>] [--] <span class="keyword">parameters</span></div></pre></td></tr></table></figure>
<p>  选项说明：<br>      -a：使getopt长参数支持”-“符号打头，必须与-l同时使用<br>      -l：后面接getopt支持长参数列表<br>      -n program：如果getopt处理参数返回错误，会指出是谁处理的这个错误，这个在调用多个脚本时，很有用<br>      -o：后面接短参数列表，这种用法与getopts类似<br>      -u：不给参数列表加引号，默认是加引号的（不使用-u选项），例如在加引号的时候 –longoption “arg1 arg2” ，只会取到”arg1”，而不是完整的”arg1 arg2”</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"><span class="comment"># A small example program for using the new getopt(1) program.</span></div><div class="line"><span class="comment"># This program will only work with bash(1)</span></div><div class="line"><span class="comment"># Note that we use `"$@"' to let each command-line parameter expand to a</span></div><div class="line"><span class="comment"># separate word. The quotes around `$@' are essential!</span></div><div class="line"><span class="comment"># We need TEMP as the `eval set --' would nuke the return value of getopt.</span></div><div class="line">TEMP=`getopt -o ab:c:: --long a-long,b-long:,c-long:: -n <span class="string">'example.bash'</span> -- <span class="string">"<span class="variable">$@</span>"</span>`</div><div class="line"><span class="keyword">if</span> [ $? != 0 ] ; <span class="keyword">then</span> <span class="built_in">echo</span> <span class="string">"Terminating..."</span> &gt;&amp;2 ; <span class="built_in">exit</span> 1 ; <span class="keyword">fi</span></div><div class="line"><span class="comment"># Note the quotes around `$TEMP': they are essential!</span></div><div class="line"><span class="built_in">eval</span> <span class="built_in">set</span> -- <span class="string">"<span class="variable">$TEMP</span>"</span></div><div class="line"><span class="keyword">while</span> <span class="literal">true</span> ; <span class="keyword">do</span></div><div class="line">        <span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></div><div class="line">                -a|--a-long) <span class="built_in">echo</span> <span class="string">"Option a"</span> ; <span class="built_in">shift</span> ;;</div><div class="line">                -b|--b-long) <span class="built_in">echo</span> <span class="string">"Option b, argument \`<span class="variable">$2</span>'"</span> ; <span class="built_in">shift</span> 2 ;;</div><div class="line">                -c|--c-long)</div><div class="line">                        <span class="comment"># c has an optional argument. As we are in quoted mode,</span></div><div class="line">                        <span class="comment"># an empty parameter will be generated if its optional</span></div><div class="line">                        <span class="comment"># argument is not found.</span></div><div class="line">                        <span class="keyword">case</span> <span class="string">"<span class="variable">$2</span>"</span> <span class="keyword">in</span></div><div class="line">                                <span class="string">""</span>) <span class="built_in">echo</span> <span class="string">"Option c, no argument"</span>; <span class="built_in">shift</span> 2 ;;</div><div class="line">                                *)  <span class="built_in">echo</span> <span class="string">"Option c, argument \`<span class="variable">$2</span>'"</span> ; <span class="built_in">shift</span> 2 ;;</div><div class="line">                        <span class="keyword">esac</span> ;;</div><div class="line">                --) <span class="built_in">shift</span> ; <span class="built_in">break</span> ;;</div><div class="line">                *) <span class="built_in">echo</span> <span class="string">"Internal error!"</span> ; <span class="built_in">exit</span> 1 ;;</div><div class="line">        <span class="keyword">esac</span></div><div class="line"><span class="keyword">done</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"Remaining arguments:"</span></div><div class="line"><span class="keyword">for</span> arg <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">'--&gt; '</span><span class="string">"\`<span class="variable">$arg</span>'"</span> ; <span class="keyword">done</span></div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line">ARGS=`getopt -a -o I:D:T:e:k:LMSsth -l instence:,database:,table:,excute:,key:,list,master,slave,status,tableview,<span class="built_in">help</span> -- <span class="string">"<span class="variable">$@</span>"</span>`</div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">usage</span></span>() &#123;</div><div class="line">    <span class="built_in">echo</span>  <span class="string">'help'</span></div><div class="line">&#125;</div><div class="line">[ $? -ne 0 ] &amp;&amp; usage</div><div class="line"><span class="comment">#set -- "$&#123;ARGS&#125;"</span></div><div class="line"><span class="built_in">eval</span> <span class="built_in">set</span> -- <span class="string">"<span class="variable">$&#123;ARGS&#125;</span>"</span></div><div class="line"><span class="keyword">while</span> <span class="literal">true</span></div><div class="line"><span class="keyword">do</span></div><div class="line">      <span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></div><div class="line">      -I|--instence)</div><div class="line">              instence=<span class="string">"<span class="variable">$2</span>"</span></div><div class="line">              <span class="built_in">shift</span></div><div class="line">              ;;</div><div class="line">      -D|--database)</div><div class="line">              database=<span class="string">"<span class="variable">$2</span>"</span></div><div class="line">              <span class="built_in">shift</span></div><div class="line">              ;;</div><div class="line">      -T|--table)</div><div class="line">              table=<span class="string">"<span class="variable">$2</span>"</span></div><div class="line">              <span class="built_in">shift</span></div><div class="line">              ;;</div><div class="line">      -e|--excute)</div><div class="line">              excute=<span class="string">"yes"</span></div><div class="line">              <span class="built_in">shift</span></div><div class="line">              ;;</div><div class="line">      -k|--key)</div><div class="line">              key=<span class="string">"<span class="variable">$2</span>"</span></div><div class="line">              <span class="built_in">shift</span></div><div class="line">              ;;</div><div class="line">      -L|--list)</div><div class="line">              LIST=<span class="string">"yes"</span></div><div class="line">              ;;</div><div class="line">      -M|--master)</div><div class="line">              MASTER=<span class="string">"yes"</span></div><div class="line">              ;;</div><div class="line">      -S|--slave)</div><div class="line">              SLAVE=<span class="string">"yes"</span></div><div class="line">              ;;</div><div class="line">      -A|--alldb)</div><div class="line">              ALLDB=<span class="string">"yes"</span></div><div class="line">              ;;</div><div class="line">      -s|--status)</div><div class="line">              STATUS=<span class="string">"yes"</span></div><div class="line">              ;;</div><div class="line">      -t|--tableview)</div><div class="line">              TABLEVIEW=<span class="string">"yes"</span></div><div class="line">              ;;</div><div class="line">      -h|--<span class="built_in">help</span>)</div><div class="line">              usage</div><div class="line">              ;;</div><div class="line">      --)</div><div class="line">              <span class="built_in">shift</span></div><div class="line">              <span class="built_in">break</span></div><div class="line">              ;;</div><div class="line">      <span class="keyword">esac</span></div><div class="line"><span class="built_in">shift</span></div><div class="line"><span class="keyword">done</span> </div><div class="line"><span class="built_in">echo</span> instence:<span class="variable">$instence</span> database:<span class="variable">$database</span> table:<span class="variable">$table</span> excute:<span class="variable">$excute</span> key:<span class="variable">$key</span></div></pre></td></tr></table></figure>
<h3 id="选项标准化"><a href="#选项标准化" class="headerlink" title="选项标准化"></a>选项标准化</h3><p>在创建shell脚本时，尽量保持选项与Linux通用的选项含义相同，Linux通用选项有：<br><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby">a 显示所有对象</span></div><div class="line"><span class="ruby">-c 生产一个计数</span></div><div class="line"><span class="ruby">-d 指定一个目录</span></div><div class="line"><span class="ruby">-e 扩展一个对象</span></div><div class="line"><span class="ruby">-f 指定读入数据的文件</span></div><div class="line"><span class="ruby">-h 显示命令的帮助信息</span></div><div class="line"><span class="ruby">-i 忽略文本大小写</span></div><div class="line"><span class="ruby">-l 产生输出得长格式文本</span></div><div class="line"><span class="ruby">-n 使用非交互模式</span></div><div class="line"><span class="ruby">-o 指定将所有输出重定向到输出文件</span></div><div class="line"><span class="ruby">-q 以安静模式运行    </span></div><div class="line"><span class="ruby">-r 递归的处理目录和文件</span></div><div class="line"><span class="ruby">-s 以安静模式运行    </span></div><div class="line"><span class="ruby">-v 生成详细输出  </span></div><div class="line"><span class="ruby">-x 排除某个对象 </span></div><div class="line"><span class="ruby">-y 对所有问题回答yes</span></div></pre></td></tr></table></figure></p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>BummingBoy</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2017/12/19/shell - 参数解析三种方式(手工, getopts, getopt)/">https://bummingboy.top/2017/12/19/shell - 参数解析三种方式(手工, getopts, getopt)/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>BummingBoy</li></ul></div><br><br><div class="tags"><a href="/tags/shell/">shell</a></div><div class="post-nav"><a class="pre" href="/2017/12/19/shell - 变量引用, 用户输入, 超时, 文本读写/">shell - 变量引用, 用户输入, 超时, 文本读写</a><a class="next" href="/2017/12/04/正则表达式 - 贪婪模式 回溯/">正则表达式 - 贪婪模式 回溯</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/centos-7/">Centos 7</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">Docker</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">JavaScript</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">Linux</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mac/">Mac</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/network/">Network</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">Node</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ios/">iOS</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/shell/">shell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tech/">tech</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/tuxera/" style="font-size: 15px;">Tuxera</a> <a href="/tags/centos7/" style="font-size: 15px;">Centos7</a> <a href="/tags/nginx/" style="font-size: 15px;">Nginx</a> <a href="/tags/linux/" style="font-size: 15px;">Linux</a> <a href="/tags/shadowsocks/" style="font-size: 15px;">shadowsocks</a> <a href="/tags/centos-7/" style="font-size: 15px;">Centos 7</a> <a href="/tags/python3/" style="font-size: 15px;">Python3</a> <a href="/tags/nodejs/" style="font-size: 15px;">Nodejs</a> <a href="/tags/docker/" style="font-size: 15px;">Docker</a> <a href="/tags/private-registry/" style="font-size: 15px;">private registry</a> <a href="/tags/chrome/" style="font-size: 15px;">Chrome</a> <a href="/tags/http/" style="font-size: 15px;">HTTP</a> <a href="/tags/长连接/" style="font-size: 15px;">长连接</a> <a href="/tags/短连接/" style="font-size: 15px;">短连接</a> <a href="/tags/javascript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/类型比较/" style="font-size: 15px;">类型比较</a> <a href="/tags/css/" style="font-size: 15px;">CSS</a> <a href="/tags/系统时间/" style="font-size: 15px;">系统时间</a> <a href="/tags/react/" style="font-size: 15px;">React</a> <a href="/tags/this/" style="font-size: 15px;">this</a> <a href="/tags/node/" style="font-size: 15px;">Node</a> <a href="/tags/浮点数/" style="font-size: 15px;">浮点数</a> <a href="/tags/mac/" style="font-size: 15px;">Mac</a> <a href="/tags/任何来源/" style="font-size: 15px;">任何来源</a> <a href="/tags/mongodb/" style="font-size: 15px;">MongoDB</a> <a href="/tags/gitlab/" style="font-size: 15px;">Gitlab</a> <a href="/tags/ntfs/" style="font-size: 15px;">NTFS</a> <a href="/tags/pm2/" style="font-size: 15px;">pm2</a> <a href="/tags/cluster/" style="font-size: 15px;">cluster</a> <a href="/tags/sketch-缓存/" style="font-size: 15px;">sketch 缓存</a> <a href="/tags/firewall/" style="font-size: 15px;">firewall</a> <a href="/tags/ios/" style="font-size: 15px;">iOS</a> <a href="/tags/崩溃日志/" style="font-size: 15px;">崩溃日志</a> <a href="/tags/commonjs/" style="font-size: 15px;">CommonJS</a> <a href="/tags/es6/" style="font-size: 15px;">ES6</a> <a href="/tags/import-export/" style="font-size: 15px;">import/export</a> <a href="/tags/du/" style="font-size: 15px;">du</a> <a href="/tags/沙盒路径/" style="font-size: 15px;">沙盒路径</a> <a href="/tags/mysql/" style="font-size: 15px;">MySQL</a> <a href="/tags/layers-of-ios/" style="font-size: 15px;">Layers of iOS</a> <a href="/tags/cocoa-touch/" style="font-size: 15px;">Cocoa Touch</a> <a href="/tags/绘图/" style="font-size: 15px;">绘图</a> <a href="/tags/core-graphics-quartz-2d/" style="font-size: 15px;">Core Graphics/QuartZ 2D</a> <a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/npm/" style="font-size: 15px;">npm</a> <a href="/tags/私有仓库/" style="font-size: 15px;">私有仓库</a> <a href="/tags/if/" style="font-size: 15px;">if</a> <a href="/tags/yum/" style="font-size: 15px;">yum</a> <a href="/tags/正则表达式/" style="font-size: 15px;">正则表达式</a> <a href="/tags/regex/" style="font-size: 15px;">RegEx</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/05/11/HTTP - 长连接 短连接/">Network - HTTP 长连接 短连接</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/11/JavaScript - the Ways to Bind JavaScript’s this Keyword in React, ES6 & ES7/">JavaScript - the Ways to Bind JavaScript’s this Keyword in React, ES6 & ES7</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/11/JavaScript - CSS3/">JavaScript - CSS3</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/26/Node - pm2 cluster 模式无法使用babel-node启动/">Node - pm2 cluster 模式无法使用babel-node启动</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/25/Linux 服务器内部无法正常解析域名/">Linux 服务器内部无法正常解析域名</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/25/Chrome 阻止自动http 跳转 https/">Chrome 阻止自动http 跳转 https</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/25/JavaScript - 类型比较及判空/">JavaScript - 类型比较及判空</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/25/shell - 判断文件夹是否存在/">shell - 判断文件夹是否存在</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/25/shell - 条件判断if中的-a到-z的意思/">shell - 条件判断 if 中 -a 到 -z 的意思</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/05/commonjs vs ES6模块机制/">CommonJS vs ES6 import/export</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">面向信仰.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/async_load_bg_image.js" async> </script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>